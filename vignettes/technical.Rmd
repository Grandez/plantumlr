---
title: "Notas tecnicas"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Notas tecnicas}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(plantumlr)
```

En este documento se indican detalles de codificacion y de arquitectura 

# Decisiones

## Clases

Se ha decidido separar la clase de PlantUML de la de generacion de diagramas de R para separar el codigo

- PLANTUML es la clase encargada de generar los diagramas
- UMLR     es la clase encargada de diagramar las clases R y hereda de PLANTUML

Se deberia mirar si es mejor tener una clase base para plantuml y dos especializaciones:
una para diagramas y su funcionalidad
otra para diagramas directos de R
Por que igual las utilidades de los diagramas no son necesarias en el codigo R

HABRA QUE HACERLO

la clase base se encarga de generar los diagramas sobre ficheros temporales


## parametro `force`

El parametro force se ha puesto publico para evitar teclear demasiado.
Se considera suficientemente simple y fijo como para mantenerlo asi

## Lectura de ficheros graficos: magick y otros

Existen paquetes para leer ficheros png, otras para jpg, etc.
Esto se utilizó para no grabar las imagenes de diagramas, mas concretamente, dado que plantuml **siempre** genera un fichero, para procesarlo y borrarlo una vez hecho.
El problema es que estos paquetes no gestionan bien el tamaño de los graficos, o al menos no he encontrado una manera correcta.

Sin embargo, creando el link a la imagen esta se muestra correctamente. Por este motivo, **todos** los diagramas se almacenan en el disco. 

## Pruebas unitarias

Dado que el paquete se integra con una libreria Java que ademas invoca un producto externo, no podemos lanzar todos los test en un entorno de integracion continua por que no disponen de esos paquetes.

Por lo tanto hay dos conjuntos de pruebas unitarias:

- Unas comunes para los entornos de integracion y de despliegue
- Unas locales para los entornos de desarrollo donde si se prueba todo el paquete

Para simplificar este proceso se ha optado por chequear una variable de entorno en el sistema:

**PLANTUMLR_DEV = T**

Si existe, se asume entorno local y se ejecutan todos los tests.

